---
import ThemeToggle from './ThemeToggle.astro';
---

<header class="header">
  <!-- Left section with menu toggle, site name, and navigation -->
  <div class="header-left">
    <!-- CSS-only mobile menu toggle that controls sidebar -->
    <label
      for="sidebar-toggle"
      class="mobile-menu-toggle"
      data-keyboard-hint="Press Enter to toggle menu">â˜°</label
    >

    <!-- LCP element optimized for immediate rendering -->
    <a href="/" class="site-name" data-keyboard-hint="Press Enter to go home">Bruce Denham</a>

    <!-- Visual separator between site name and navigation -->
    <div class="nav-separator"></div>

    <!-- Navigation - visible until 640px, aligned with site name -->
    <nav class="main-nav" aria-label="Main navigation" id="main-navigation">
      <a href="/about/" class="nav-link" data-keyboard-hint="Press Enter to view About page"
        >About</a
      >
      <a href="/work/" class="nav-link" data-keyboard-hint="Press Enter to view Work page">Work</a>
      <a href="/projects/" class="nav-link" data-keyboard-hint="Press Enter to view Projects page"
        >Projects</a
      >
      <a href="/blog/" class="nav-link" data-keyboard-hint="Press Enter to view Blog page">Blog</a>
    </nav>
  </div>

  <div class="header-right">
    <!-- Simplified social links - text-based for faster LCP -->
    <div class="social-links">
      <a
        href="https://github.com/bdenham"
        target="_blank"
        rel="noopener"
        class="social-link"
        aria-label="GitHub"
      >
        <span class="social-text-full">GitHub</span>
        <span class="social-text-short">GH</span>
      </a>
      <a
        href="https://linkedin.com/in/brucedenham"
        target="_blank"
        rel="noopener"
        class="social-link"
        aria-label="LinkedIn"
      >
        <span class="social-text-full">LinkedIn</span>
        <span class="social-text-short">LI</span>
      </a>
      <a href="mailto:brucedenham@mac.com" class="social-link social-link-email" aria-label="Email">
        <span class="social-text-full">Email</span>
        <span class="social-text-short">@</span>
      </a>
    </div>

    <ThemeToggle />
  </div>
</header>

<style>
  /* Header layout - single line, no wrapping */
  .header {
    display: flex;
    align-items: center;
    gap: 16px;
  }

  /* Create a flex layout that keeps site name and nav left-aligned */
  .header-left {
    display: flex;
    gap: 8px;
    flex: 1;
    align-items: center;
  }

  /* Site name styling */
  .site-name {
    flex-shrink: 0; /* Prevent site name from shrinking */
    font-size: 1.5rem; /* Smaller than default 1.75rem */
    white-space: nowrap; /* Prevent site name from wrapping */
  }

  /* Visual separator between site name and navigation */
  .nav-separator {
    width: 1px;
    height: 28px;
    background: var(--text-tertiary);
    margin: 0 16px; /* Equal spacing on both sides */
  }

  /* CSS-only mobile menu toggle that controls sidebar */
  .mobile-menu-toggle {
    display: none; /* Hidden on desktop */
    background: none;
    border: none;
    font-size: 1.5rem;
    color: var(--text-primary);
    cursor: pointer;
    border-radius: 4px;
    transition: background-color 0.2s ease;
    margin-top: -0.2rem;
  }

  .mobile-menu-toggle:hover {
    background: var(--bg-card-hover);
  }

  /* Navigation styles */
  .main-nav {
    display: flex;
    gap: 32px; /* More generous spacing for 4 links */
    padding-top: 0.25rem;
  }

  .nav-link {
    color: var(--text-secondary);
    text-decoration: none;
    font-size: 0.9rem;
    font-weight: 500;
    padding: 8px 0;
    transition:
      color 0.2s ease,
      border-color 0.2s ease;
  }

  .nav-link:hover {
    color: var(--accent-primary);
    border-bottom-color: var(--accent-primary);
  }

  .header-right {
    display: flex;
    align-items: center;
    gap: 16px;
  }

  .social-links {
    display: flex;
    gap: 12px;
  }

  .social-link {
    color: var(--text-secondary);
    text-decoration: none;
    font-size: 0.9rem;
    padding: 4px 8px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    gap: 4px;
    white-space: nowrap; /* Prevent text wrapping */
  }

  .social-link:hover {
    color: var(--accent-primary);
  }

  /* Responsive text switching */
  .social-text-full {
    display: inline;
  }

  .social-text-short {
    display: none;
  }

  /* Mobile responsive - smart navigation strategy */

  /* Show nav links on larger screens (desktop with sidebar), hide menu toggle */
  @media (min-width: 1024px) {
    .mobile-menu-toggle {
      display: none; /* Hide hamburger menu above 1024px */
    }
    .main-nav {
      display: flex; /* Show nav links */
    }
  }

  /* Hide nav links on smaller screens (tablet/mobile without sidebar), show menu toggle */
  @media (max-width: 1023px) {
    .mobile-menu-toggle {
      display: block; /* Show hamburger menu below 1024px */
    }
    .main-nav {
      display: none; /* Hide nav links on smaller screens */
    }
    .nav-separator {
      display: none; /* Hide separator when nav is hidden */
    }
  }

  @media (max-width: 768px) {
    .site-name {
      font-size: 1.375rem; /* Slightly smaller on tablet */
    }

    .main-nav {
      gap: 24px; /* Still generous on tablet */
    }

    .nav-link {
      font-size: 0.85rem; /* Smaller nav text on tablet */
    }

    .header-right {
      gap: 10px; /* Reduce right section gap */
    }

    .social-links {
      gap: 6px; /* Tighter social link spacing */
    }

    /* Switch to abbreviated text on tablets */
    .social-text-full {
      display: none;
    }

    .social-text-short {
      display: inline;
    }
  }

  @media (max-width: 640px) {
    .site-name {
      font-size: 1.25rem; /* Smaller site name on mobile */
    }

    .header-right {
      gap: 8px; /* Minimal right section gap */
    }

    .social-links {
      gap: 6px; /* Very tight social link spacing */
    }

    /* Keep abbreviated text on mobile */
    .social-text-full {
      display: none;
    }

    .social-text-short {
      display: inline;
    }
  }

  /* Extra small screens - hide some elements to prevent wrapping */
  @media (max-width: 440px) {
    .site-name {
      font-size: 1.125rem; /* Even smaller site name */
    }

    .header-right {
      gap: 6px; /* Minimal gap */
    }

    /* Hide email link on very small screens */
    .social-link-email {
      display: none;
    }

    .social-links {
      gap: 4px; /* Minimal social spacing */
    }

    .social-link {
      font-size: 0.8rem; /* Smaller text */
      padding: 2px 6px; /* Tighter padding */
    }
  }
</style>

<script>
  // CSS-only mobile menu - no JavaScript needed for toggle functionality
  document.addEventListener('DOMContentLoaded', () => {
    // Enhanced keyboard navigation for nav links
    const navLinks = document.querySelectorAll<HTMLAnchorElement>('.nav-link');
    navLinks.forEach((link, index) => {
      link.addEventListener('keydown', (e: KeyboardEvent) => {
        if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
          e.preventDefault();
          const nextIndex = (index + 1) % navLinks.length;
          navLinks[nextIndex].focus();
        } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
          e.preventDefault();
          const prevIndex = (index - 1 + navLinks.length) % navLinks.length;
          navLinks[prevIndex].focus();
        }
      });
    });

    // Skip link functionality
    const skipLink = document.querySelector<HTMLAnchorElement>('.skip-link');
    if (skipLink) {
      skipLink.addEventListener('click', (e: Event) => {
        e.preventDefault();
        const href = skipLink.getAttribute('href');
        if (href) {
          const target = document.querySelector<HTMLElement>(href);
          if (target) {
            target.focus();
            target.scrollIntoView({ behavior: 'smooth' });
          }
        }
      });
    }
  });
</script>
