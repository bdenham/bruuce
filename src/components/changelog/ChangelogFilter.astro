---
const allComponents = [
  'Cart',
  'Checkout',
  'Order',
  'Payment Services',
  'Product details',
  'Storefront Compatibility Package',
  'User auth',
  'User account'
];

const allTypes = ['feature', 'update', 'fix', 'deprecation'];
---

<div class="changelog-filter">
  <div class="filter-group">
    <label for="component-filter">Filter by Component:</label>
    <select id="component-filter" class="filter-select">
      <option value="">All Components</option>
      {allComponents.map(component => (
        <option value={component}>{component}</option>
      ))}
    </select>
  </div>

  <div class="filter-group">
    <label for="type-filter">Filter by Type:</label>
    <select id="type-filter" class="filter-select">
      <option value="">All Types</option>
      {allTypes.map(type => (
        <option value={type}>{type.charAt(0).toUpperCase() + type.slice(1)}</option>
      ))}
    </select>
  </div>
</div>

<script>
  const componentFilter = document.getElementById('component-filter') as HTMLSelectElement | null;
  const typeFilter = document.getElementById('type-filter') as HTMLSelectElement | null;
  const entries = document.querySelectorAll<HTMLElement>('.changelog-entry');

  function filterEntries() {
    if (!componentFilter || !typeFilter) return;

    const selectedComponent = componentFilter.value;
    const selectedType = typeFilter.value;

    entries.forEach(entry => {
      const components = entry.getAttribute('data-components')?.split(',') || [];
      const type = entry.getAttribute('data-type');
      
      const componentMatch = !selectedComponent || components.includes(selectedComponent);
      const typeMatch = !selectedType || type === selectedType;

      if (entry instanceof HTMLElement) {
        entry.style.display = componentMatch && typeMatch ? 'block' : 'none';
      }
    });
  }

  if (componentFilter) {
    componentFilter.addEventListener('change', filterEntries);
  }
  if (typeFilter) {
    typeFilter.addEventListener('change', filterEntries);
  }
</script>