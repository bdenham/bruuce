---
title: Event Handling
description: Learn about how the Checkout drop-in handles events.
---

The Checkout drop-in uses an event-driven architecture with key events based on the `@adobe-commerce/event-bus` package for communication between components. This event mechanism allows containers to react to changes in the application state, maintain decoupled communication, and synchronize their state with the cart.

## Event System Architecture

The system uses a publish-subscribe pattern where containers can:

1. Subscribe to specific events using `events.on()`
2. Emit events using `events.emit()`
3. Unsubscribe using `subscription.off()`

## Events declaration

Find below the list of contracts defined between each event and its payload:

```js title='event-bus.d.ts'
import {
  Cart as CheckoutData,
  ShippingEstimate,
  ValuesModel,
} from '@/checkout/data/models';
import { CartModel } from '@/checkout/types/cart';

declare module '@adobe-commerce/event-bus' {
  interface Events {
    'checkout/initialized': CheckoutData | null;
    'checkout/updated': CheckoutData | null;
    'checkout/values': ValuesModel;
    'shipping/estimate': ShippingEstimate;
    'cart/initialized': CartModel | null;
    'cart/updated': CartModel | null;
    'cart/reset': void;
    'cart/merged': { oldCartItems: any[] };
    authenticated: boolean;
    error: { source: string; type: string; error: Error };
  }

  interface Cart extends CartModel {}
}
```

## Subscription of events

If a component wants to listen for an event fired in another component, the component must subscribe to that event.

### Subscription configuration

To subscribe to an event, you must provide the following information:

1. The name of the event
2. The event handler; it's a callback function to be executed in case a new event is fired (the payload is passed as parameter)
3. Event subscriptions can include an additional configuration parameter:
    - _eager: true_; The handler will execute immediately if the event has been emitted previously
    - _eager: false_; The handler will only respond to future emissions of the event

```js
const subscription = events.on('event-name', handler, { eager: true/false });
```

### Events subscribed by containers

Find below the list of events subscribed by the Checkout drop-in containers:

#### (i) External

When the event is fired by external components:

- **'authenticated'**: Indicates that a user has authenticated.
- **'cart/initialized'**: Indicates that a new cart has been created and initialized.
- **'cart/reset'**: Indicates that the order has been placed and the cart is not active any more.
- **'cart/updated'**: Indicates that the cart data has been added or updated.
- **'cart/merged'**: Indicates that a guest cart (created during the anonymous checkout) has been merged with a customer cart (recovered from a previous checkout process).
- **'cart/data'**: Provides cart data.
- **'locale'**: Indicates that the locale has been changed.

#### (ii) Internal

When the event is fired by internal Checkout drop-in components:

- **'checkout/initialized'**: Indicates that the checkout drop-in has been initialized with cart data.
- **'checkout/updated'**: Indicates that the checkout data has been added or updated.
- **'shipping/estimate'**: Provides shipping estimate based on shipping method selected within a shipping address.

### Example

Listen to the checkout initialization event:

```js
events.on('checkout/initialized', (data) => {
  // Handle checkout data
});
```

## Emission of events

Each component is able to emit an event if it wants to share some information to the rest of components or drop-ins.

### Emission configuration

To emit an event, you must provide the following information:

1. The name of the event
2. The payload containing the data to be shared

```js
events.emit('event-name', payload);
```

### Events emitted by containers

Find below the list of events emitted by the Checkout drop-in containers:

- **'checkout/initialized'**: Indicates that the checkout drop-in has been initialized with cart data.
- **'checkout/updated'**: Indicates that the checkout data has been added or updated.
- **'checkout/values'**: Provides the local state values.
- **'shipping/estimate'**: Provides shipping estimate based on shipping method selected within a shipping address.
- **'error'**: Indicates that the system has received a network error type.

### Example

Emit the checkout values event:

```js
events.emit('checkout/values', data);
```
