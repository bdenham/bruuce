---
title: Indexing and metadata
description: Boost your Adobe Commerce SEO on Edge Delivery Services! Follow our guidelines on data layers, canonical URLs, redirects, sitemaps, and metadata.
---

For Live Search and Product Recommendation APIs to work correctly, you must collect and send user interaction events to Commerce.

User interaction evets power Adobe Sensei features, like intelligent merchandising for Live Search and to personalize product recommendations units. These events also populate performance dashboards for [Live Search](https://experienceleague.adobe.com/en/docs/commerce-merchant-services/live-search/live-search-admin/performance) and [Product Recommendations](https://experienceleague.adobe.com/en/docs/commerce-merchant-services/product-recommendations/admin/workspace).

## Adobe Client Data Layer (ACDL)

The boilerplate includes the [Adobe Client Data Layer (ACDL)](https://github.com/adobe/adobe-client-data-layer) by default.

To validate events, you can use [this draft validator](https://github.com/adobe/adobe-client-data-layer/pull/156). Events written to ACDL must comply to a specific schema as defined by the [Storefront Event SDK](https://github.com/adobe/commerce-events/tree/main/packages/storefront-events-sdk).

For performance considerations, Adobe highly recommends writing events to the ACDL directly without using the Events SDK. Dropins and widgets will send events to ACDL out of the box, but you should double-check the correctness of all events.

The boilerplate loads the [Storefront Events Collector](https://github.com/adobe/commerce-events/tree/main/packages/storefront-events-collector) in the delayed phase to automatically send those events. For the collector to work, you must ensure that the configuration file is properly populated with all configuration parameters. The configuration parameters are a mix between those that are required for Catalog Service access and some specific to data services. The easiest way to retrieve them is using the `magento/module-data-services-graphql` module, which exposes additional GraphQL functionality.

import Aside from '@components/Aside.astro';
import { Tabs, TabItem, Steps } from '@astrojs/starlight/components';

Optimizing Adobe Commerce storefronts on Edge Delivery Services for search engines requires guidance. The general recommendations provided here are inspired by customers and partners who have built storefront projects on Edge Delivery Services.

## Indexing

The following best practices are designed to help you ensure that your site is indexed correctly by search engines.

### Canonical URLs

* When product detail pages (PDPs) have multiple URLs, set a consistent canonical URL for each product.
* Make sure that canonical URLs do not point to redirects (301).

### Configurable products

For configurable products, ensure that the canonical URL is set to the parent product URL. This is important because Google might index the child product URLs, which can lead to duplicate content issues.

### Folder mapping

When using [folder mapping](https://www.aem.live/developer/folder-mapping) for Commerce pages (PDP, PLP) ensure that the server-side rendered response contains metadata that allows Google to differentiate pages.

Folder-mapped pages (without using [bulk metadata](https://www.aem.live/docs/bulk-metadata)) all look the same and Google might classify them as duplicate and not index them, despite different canonical URLs as Google considers canonical URLs a hint and not an absolute value.

### Multi-store setups

For multi-store setups or stores supporting multiple locales:

* Verify a [correct hreflang setup](https://www.aem.live/developer/sitemap#specifying-the-primary-language-manually). You can validate using the [hreflang Tags Testing Tool](https://technicalseo.com/tools/hreflang/)

* Verify that the store code is part of the URL for every Catalog Service or Live Search request. This is required because Google caches Catalog Service responses without considering headers. Not adding the store code to the URL might lead to Google indexing the wrong data.

  :::tip
  You can ensure this by [proxying the Catalog Service endpoint](/implementation/setup/content-delivery-network/) through Fastly. Alternatively, you can add a query parameter, but this method is incompatible with dropins.
  :::

### Redirects

Ensure proper redirects are set up using the redirects sheet or through your [CDN](/implementation/setup/content-delivery-network/).

* Fallbacks for any potential URL changes (for example, product URLs or missing .html suffixes)
* Redirects that are set up in Adobe Commerce

### Sitemaps

* Submit new sitemaps through Google Search Console (Google takes a while to detect new sitemaps).
* If your site is using more than one sitemap, reference all sitemaps in your site's `robots.txt` file.
* Ensure that all sitemaps are valid using the [hreflang Tags Testing Tool](https://technicalseo.com/tools/hreflang/).

### Other

* You can validate indexing using Google Search Console by inspecting the markup of the crawl to see if all important information were tracked.
* Transactional pages (for example, cart, checkout, and account) should not be indexed.
* Staging or any non-production environments must not be indexed. Once indexed, URLs from a staging environment can reduce traffic to the production environment. It might take a significant amount of time to remove staging URLs from the Google index.

## Metadata

Adobe recommends uploading product metadata into Edge Delivery Services so that it can be rendered server-side on product detail pages. This is important so that Google Merchant Center can reliably verify entries from your product sheet. Also, social media sites, which don't usually parse JavaScript, can leverage this metadata to display rich previews of your product page links.

Verify that all pages, especially catalog pages (PDP and PLP), contain the following metadata:

| Type                      | Properties                                                                                                                                                              |
|---------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Document title            | `title`                                                                                                                                                                 |
| Meta tags                 | `description`, `keywords`, `og:type`, `og:title`, `og:description`, `og:url`, `og:image`, `og:image:secure_url`, `og:product:price:amount`, `og:product:price:currency` |
| Schema.org data (JSON-LD) | `WebSite`, `Product`, `AggregateRating`, `Rating`, `BreadcrumbList`                                                                                                     |

:::note
When importing pages, ensure that when a metadata block is present on a page, it does not contain any empty fields. This might lead to pages with missing titles, which Google penalizes.
:::

### Schema.org data (JSON-LD)

JavaScript Object Notation for Linked Data (JSON-LD) is a structured data format that helps search engines understand the content of your web pages more explicitly. It is typically added as a script tag in the `<head>` of your HTML document.

Adobe Commerce storefronts on Edge Delivery Services should include [schema.org](https://schema.org/) annotations to expose product data to search engines. This data should be included on all Commerce pages, especially PDPs and PLPs.

You should compare the data available on the site before migrating to Edge Delivery Services to ensure that SKUs for all product variants are included. Use the [Rich Results Test](https://search.google.com/test/rich-results) to validate the schema.org annotations. The PDP dropin in the boilerplate contains an example for JSON-LD data.

:::note
If you are using Google Shopping features (for example, products available on `shopping.google.com`), consider schema.org annotations with critical priority. If a single JSON-LD annotation on the page is invalid, Google considers all annotations invalid.
:::

### Generate metadata

You can use the [PDP Metadata Generator](https://github.com/hlxsites/aem-boilerplate-commerce/tree/main/tools/pdp-metadata) tool to automate the process of generating all recommended metadata. The tool fetches product data from the Catalog Service, processes it, and generates a metadata spreadsheet in `.xslx` format. The spreadsheet can be used for the [bulk metadata](https://www.aem.live/docs/bulk-metadata) feature in Edge Delivery Services.

<Aside type="cool" title="Prerequisites">
* Node.js installed on your machine
* Access to the Catalog Service with the necessary API keys and configuration
* Commerce boilerplate repository cloned to your local machine
</Aside>

To generate metadata using the PDP Metadata Generator tool:

<Steps>

1. Navigate to the `tools/pdp-metadata/` directory in your local project.
1. Install dependencies.
  
   ```bash
   npm install
   ```

   :::note
   Before running the tool, you must ensure that the `configFile` variable in the `pdp-metadata.js` file points to the correct configuration JSON file URL. This file contains the required parameters to access the Catalog Service API and should have been setup as part of your [project onboarding](/implementation/setup/commerce-configuration/).
   :::

1. Run the tool and generate a file named `metadata.xlsx` in the project directory.

   ```bash
   npm start
   ```

</Steps>

The resulting `metadata.xlsx` file contains all recommended metadata for all of your products. See the [bulk metadata](https://www.aem.live/docs/bulk-metadata) documentation for instructions on how to upload the generated metadata file to Edge Delivery Services.