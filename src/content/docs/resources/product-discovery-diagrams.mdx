---
title: Product Discovery Diagrams
---

import Diagram from '@components/Diagram.astro';

## Search sequence diagram

<Diagram 
  type="mermaid" 
  caption="Search sequence diagram"
  code={`sequenceDiagram
    participant U as User
    participant API as search() API
    participant EB as Event Bus
    participant SR as SearchResults
    participant F as Facets
    participant P as Pagination
    participant S as SortBy
    participant GQL as GraphQL API

    %% Initial search
    U->>API: search({phrase: "shirts"})
    API->>GQL: request data from Catalog Services
    GQL-->>API: return results
    API->>EB: emit('search/loading', true)
    API->>EB: emit('search/result', { request, result })
    API->>EB: emit('search/loading', false)
    
    %% All containers receive loading and result events
    EB->>SR: search/loading<br/>search/result
    EB->>F: search/loading<br/>search/result
    EB->>P: search/loading<br/>search/result
    EB->>S: search/loading<br/>search/result
`}
/>

## Search sequence diagram with scope

<Diagram 
  type="mermaid" 
  caption="Search sequence diagram with scope"
  code={`sequenceDiagram
    participant U as User
    participant API as search() API
    participant EB as Event Bus
    participant SR as SearchResults<br/>(scope: "popover")
    participant GQL as GraphQL API

    %% Quick search
    U->>API: search({phrase: "shirt"}, {scope: "popover"})
    API->>GQL: request data from Catalog Services
    GQL-->>API: return results
    API->>EB: emit('search/loading', true, {scope: "popover"})
    API->>EB: emit('search/result', { request, result }, {scope: "popover"})
    API->>EB: emit('search/loading', false, {scope: "popover"})
    
    %% Only SearchResults receives events (scoped)
    EB->>SR: search/loading<br/>search/result (scope: "popover")
`}
/>
