---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import { pathWithBase } from '../../utils/base';

export async function getStaticPaths() {
  const blogPosts = await getCollection('blog');
  return blogPosts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();

title: post.data.title;
description: post.data.excerpt;
---

<BaseLayout
  title={`${post.data.title} - Bruce Denham`}
  description={post.data.excerpt}
  showBackLink={true}
  backLinkText="← Back to Blog"
  backLinkHref={pathWithBase('/blog/')}
  footerText="Thanks for reading! "
  footerLinkText="Browse more posts"
  footerLinkHref={pathWithBase('/blog/')}
>
  <h1 id="post-title">{post.data.title}</h1>
  <p class="date">
    Published: {
      post.data.date.toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric',
      })
    }
  </p>
  <div class="content">
    <Content />
  </div>
</BaseLayout>

<style>
  /* Blog post specific styles */
  .date {
    margin: 0 0 32px 0;
    color: var(--text-dim);
    font-size: 16px;
  }
</style>
