---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import BlogPostCard from '../../components/ui/BlogPostCard.astro';
import PageHeader from '../../components/ui/PageHeader.astro';

// Get all blog posts and sort by date (newest first)
const blogPosts = await getCollection('blog');
// Filter out draft posts in production
const publishedPosts = blogPosts.filter((post) => !post.data.draft);
const sortedPosts = publishedPosts.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

// Get featured posts
const featuredPosts = sortedPosts.filter((post) => post.data.featured);

// Get all categories and tags for filtering
const allCategories = [...new Set(sortedPosts.map((post) => post.data.category).filter(Boolean))];
const allTags = [...new Set(sortedPosts.flatMap((post) => post.data.tags || []))];
---

<BaseLayout
  title="My Blog - Bruce Denham"
  description="Reflections on technology, personal growth, life's complexities, and the human experience in our modern world."
  showBackLink={true}
  backLinkText="← Back to Home"
  backLinkHref="/"
  footerText="More insights coming soon! "
  footerLinkText="Connect with me on LinkedIn"
  footerLinkHref="https://linkedin.com/in/brucedenham/"
>
  <PageHeader primary="My" accent="Blog" class="page-title" />
  <p class="text-large lead animate-in animate-delay-100">
    Reflections on technology, writing, personal growth, life's existential challenges, and
    navigating the complexities of our modern world.
  </p>

  <div class="blog-posts-container animate-in animate-delay-150">
    {sortedPosts.map((post) => <BlogPostCard post={post} />)}
  </div>

  <!-- LinkedIn Posts & Insights Section -->
  <div class="section-container animate-in animate-delay-200">
    <div class="section-divider"></div>
    <h2 class="section-heading">LinkedIn Posts</h2>
    <p class="text-large intro">
      Thoughtful reflections I share on LinkedIn about kindness, personal growth, and authentic
      human connection — exploring how we grow, how we connect, and how our vulnerabilities can
      become our greatest strengths.
    </p>

    <div class="linkedin-posts grid-large grid-with-bottom-margin">
      <a
        href="https://www.linkedin.com/feed/update/urn:li:activity:7329128517764337665/"
        target="_blank"
        rel="noopener noreferrer"
        class="linkedin-post featured"
      >
        <div class="post-header">
          <div class="platform-info">
            <div class="platform-icon"></div>
            <div class="platform-text">
              <span class="platform-name">LinkedIn</span>
              <span class="post-type">Creative Post</span>
            </div>
          </div>
          <div class="post-date">Recent</div>
        </div>
        <div class="post-content">
          <h3>The Science of Kindness</h3>
          <p>
            What if kindness moved like diffusion—not with force, but with grace, filling absence
            with abundance, and longing with love? Let what's full in you flow where it's needed.
            That's how the world softens.
          </p>
          <div class="post-details">
            <span class="post-tag">Animation</span>
            <span class="post-tag">Kindness</span>
            <span class="post-tag">Visual Communication</span>
          </div>
        </div>
      </a>

      <a
        href="https://www.linkedin.com/feed/update/urn:li:activity:7326230647159619585/"
        target="_blank"
        rel="noopener noreferrer"
        class="linkedin-post"
      >
        <div class="post-header">
          <div class="platform-info">
            <div class="platform-icon">🔗</div>
            <div class="platform-text">
              <span class="platform-name">LinkedIn</span>
              <span class="post-type">Professional Update</span>
            </div>
          </div>
          <div class="post-date">Recent</div>
        </div>
        <div class="post-content">
          <h3>What is Personal Growth?</h3>
          <p>
            Why does personal growth often feel so elusive? One step forward, two steps back. Ten
            steps forward, wrong direction. Am I missing something? Maybe...Probably.
          </p>
          <div class="post-details">
            <span class="post-tag">Growth</span>
            <span class="post-tag">Animation</span>
            <span class="post-tag">Visual Communication</span>
          </div>
        </div>
      </a>

      <a
        href="https://www.linkedin.com/feed/update/urn:li:activity:7326968144617492480/"
        target="_blank"
        rel="noopener noreferrer"
        class="linkedin-post"
      >
        <div class="post-header">
          <div class="platform-info">
            <div class="platform-icon">🔗</div>
            <div class="platform-text">
              <span class="platform-name">LinkedIn</span>
              <span class="post-type">Community Engagement</span>
            </div>
          </div>
          <div class="post-date">Recent</div>
        </div>
        <div class="post-content">
          <h3>Cracks Let the Light In</h3>
          <p>
            We grow up thinking polish makes us lovable. So we shine the surface, hoping to be seen.
            But it's our presence, not perfection, that opens hearts. And it's our cracks that let
            the light in.
          </p>
          <div class="post-details">
            <span class="post-tag">Growth</span>
            <span class="post-tag">Animation</span>
            <span class="post-tag">Visual Communication</span>
          </div>
        </div>
      </a>
    </div>

    <div class="linkedin-cta">
      <a
        href="https://linkedin.com/in/brucedenham/"
        target="_blank"
        rel="noopener noreferrer"
        class="linkedin-follow-btn"
      >
        Follow me on LinkedIn →
      </a>
    </div>
  </div>
</BaseLayout>

<style>
  /* LinkedIn Insights section specific styles */
  .linkedin-insights-section {
    margin-top: 0;
    padding-top: 32px;
  }

  .section-divider {
    height: 2px;
    background: linear-gradient(90deg, var(--accent-primary), transparent);
    border-radius: 1px;
    margin-bottom: 32px;
    max-width: 200px;
  }

  .posts-intro {
    color: var(--text-primary);
    margin-bottom: 32px;
    font-weight: 400;
    line-height: 1.6;
  }

  /* Platform info styles - from homepage */
  .platform-info {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .platform-icon {
    font-size: 1.2rem;
  }

  .platform-text {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .platform-name {
    color: var(--text-primary);
    font-size: 1rem;
    font-weight: 600;
  }

  .post-type {
    color: var(--text-muted);
    font-size: 12px;
  }

  .post-date {
    color: var(--text-muted);
    font-size: 12px;
    font-weight: 500;
  }

  .post-content h3 {
    color: var(--text-primary);
    font-size: 18px;
    margin: 0 0 12px 0;
  }

  .post-content p {
    color: var(--text-tertiary);
    line-height: 1.6;
    margin: 0 0 16px 0;
    font-weight: 400;
  }

  .post-details {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-bottom: 16px;
  }

  /* LinkedIn post content styling */
  .linkedin-post .post-content {
    flex: 1;
    min-width: 0;
  }

  .linkedin-post .post-content h3 {
    margin: 0 0 0.25rem 0;
    font-size: 1.125rem;
    color: var(--text-primary);
    font-weight: 600;
    line-height: 1.4;
  }

  .linkedin-post .post-content p {
    margin: 0 0 0.5rem 0;
    color: var(--text-tertiary);
    line-height: 1.5;
    font-size: 1.125rem;
  }

  /* Hide the old post-header since we're using icons as bullets */
  .linkedin-post .post-header {
    display: none;
  }

  /* Mobile responsive for LinkedIn posts */
  @media (max-width: 640px) {
    .post-details {
      gap: 4px;
    }
  }
</style>
